<!DOCTYPE html>
<html lang="pt-MZ">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ZQ Saúde+ Quiz</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');

  body {
    margin:0; padding:0;
    font-family: 'Roboto', sans-serif;
    background: #f0f4f8;
    color: #10375c;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
  }

  /* Splash Screen */
  #splash {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: #104e8b;
    color: #cce7ff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-size: 3rem;
    font-weight: 700;
    text-align: center;
    z-index: 9999;
    user-select: none;
  }
  #splash small {
    font-size: 1.2rem;
    margin-top: 0.6rem;
    font-weight: 400;
  }
  /* Subtítulo animação com imagens (simples) */
  #splash-images {
    display: flex;
    margin-top: 1rem;
    gap: 15px;
  }
  #splash-images img {
    width: 60px;
    height: 60px;
    filter: drop-shadow(1px 1px 1px rgba(0,0,0,0.2));
    animation: bounce 2s infinite alternate;
  }
  #splash-images img:nth-child(2) { animation-delay: 0.3s; }
  #splash-images img:nth-child(3) { animation-delay: 0.6s; }
  #splash-images img:nth-child(4) { animation-delay: 0.9s; }

  @keyframes bounce {
    from { transform: translateY(0); }
    to { transform: translateY(-15px); }
  }

  /* Containers */
  .container {
    background: #fff;
    box-shadow: 0 5px 15px rgba(0,0,0,0.15);
    border-radius: 12px;
    max-width: 480px;
    width: 90%;
    margin: 2rem auto;
    padding: 20px 30px;
  }

  /* Formulário Login */
  label {
    display: block;
    margin-top: 15px;
    font-weight: 600;
    color: #10375c;
  }
  input {
    width: 100%;
    padding: 10px;
    margin-top: 6px;
    border: 1.8px solid #10375c;
    border-radius: 8px;
    font-size: 1rem;
    color: #10375c;
    background: #f5faff;
  }
  input:focus {
    outline: none;
    border-color: #4a90e2;
    box-shadow: 0 0 6px #4a90e2;
  }
  button {
    margin-top: 20px;
    background: #10375c;
    color: #cce7ff;
    border: none;
    border-radius: 10px;
    padding: 14px;
    font-size: 1.2rem;
    cursor: pointer;
    font-weight: 700;
    transition: background-color 0.3s ease;
    width: 100%;
  }
  button:hover {
    background: #0a2c4e;
  }

  /* Quiz */
  #quizContainer {
    display: none;
    flex-direction: column;
  }
  #question {
    font-size: 1.3rem;
    font-weight: 600;
    margin-bottom: 20px;
    min-height: 70px;
  }
  #answers {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }
  button.answerBtn {
    background: #d1e8ff;
    border: 2px solid #10375c;
    border-radius: 10px;
    padding: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.25s ease;
  }
  button.answerBtn:hover, button.answerBtn:focus {
    background-color: #10375c;
    color: #cce7ff;
    outline: none;
  }

  /* Timer Bar */
  #timerBar {
    height: 15px;
    width: 100%;
    background: #e3f0ff;
    border-radius: 10px;
    overflow: hidden;
    margin-top: 20px;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
  }
  #timerFill {
    height: 100%;
    width: 100%;
    background: #10375c;
    transition: width 1s linear;
  }

  /* Score */
  #scoreBoard {
    margin-top: 18px;
    font-weight: 700;
    font-size: 1.1rem;
    color: #10375c;
    text-align: center;
  }

  /* Botões adicionais */
  #btnViewRanking, #btnLogout {
    margin-top: 20px;
    background: #4a90e2;
    border-radius: 10px;
    padding: 12px;
    font-weight: 700;
    font-size: 1.1rem;
    color: white;
    border: none;
    cursor: pointer;
    width: 100%;
  }
  #btnViewRanking:hover, #btnLogout:hover {
    background: #357ABD;
  }

  /* Ranking */
  #rankingContainer {
    display: none;
  }
  #rankingList {
    list-style: decimal inside;
    font-size: 1.2rem;
    padding-left: 10px;
    margin-bottom: 20px;
  }
  #rankingList li {
    margin-bottom: 8px;
    font-weight: 600;
    color: #10375c;
  }
  #btnBackToQuiz {
    background: #4a90e2;
    border-radius: 10px;
    border: none;
    padding: 12px;
    font-weight: 700;
    font-size: 1.1rem;
    color: white;
    cursor: pointer;
    width: 100%;
  }
  #btnBackToQuiz:hover {
    background: #357ABD;
  }

  /* Admin area - visible only on desktop */
  @media (max-width: 850px) {
    #adminArea {
      display: none !important;
    }
  }
  #adminArea {
    display: none;
    max-width: 900px;
    margin: 2rem auto;
    background: #cce7ff;
    border-radius: 15px;
    padding: 20px 30px;
    box-shadow: 0 5px 25px rgba(0,0,0,0.2);
  }
  #adminArea h2 {
    color: #10375c;
    margin-bottom: 20px;
  }
  #adminUsersList {
    max-height: 320px;
    overflow-y: auto;
    border: 2px solid #10375c;
    border-radius: 10px;
    padding: 12px;
    background: #e8f3ff;
    color: #10375c;
    font-size: 0.9rem;
  }
  #adminUsersList table {
    width: 100%;
    border-collapse: collapse;
  }
  #adminUsersList th, #adminUsersList td {
    border: 1px solid #10375c;
    padding: 8px 10px;
    text-align: left;
  }
  #adminUsersList th {
    background-color: #357ABD;
    color: #fff;
  }
  #adminButtons {
    margin-top: 20px;
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
  }
  #adminButtons button {
    flex: 1 1 200px;
    background: #10375c;
    color: #cce7ff;
    border: none;
    border-radius: 12px;
    padding: 12px;
    font-weight: 700;
    font-size: 1rem;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  #adminButtons button:hover {
    background: #0a2c4e;
  }

  /* Fixed ad banner */
  #adBanner {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    background: #104e8b;
    color: #cce7ff;
    font-weight: 700;
    font-family: 'Roboto', sans-serif;
    padding: 10px 0;
    text-align: center;
    user-select: none;
    z-index: 10000;
  }
</style>
</head>
<body>

<!-- Splash Screen -->
<div id="splash" role="alert" aria-live="assertive" aria-atomic="true">
  ZQ Saúde+<br>
  <small>Ganhe com o seu conhecimento!</small>
  <div id="splash-images" aria-hidden="true">
    <img src="https://img.icons8.com/ios-filled/100/ffffff/heartbeat.png" alt="Ícone batimento cardíaco" />
    <img src="https://img.icons8.com/ios-filled/100/ffffff/first-aid-kit.png" alt="Ícone kit primeiros socorros" />
    <img src="https://img.icons8.com/ios-filled/100/ffffff/microscope.png" alt="Ícone microscópio" />
    <img src="https://img.icons8.com/ios-filled/100/ffffff/pills.png" alt="Ícone pílulas" />
  </div>
</div>

<!-- Login / Cadastro -->
<div class="container" id="loginContainer" role="main" aria-label="Login e Cadastro">
  <h1>Bem-vindo ao ZQ Saúde+ Quiz</h1>
  <form id="loginForm" aria-describedby="formDesc" novalidate>
    <p id="formDesc">Preencha o formulário para jogar e concorrer a prêmios semanais.</p>

    <label for="fullName">Nome Completo *</label>
    <input type="text" id="fullName" name="fullName" required autocomplete="name" />

    <label for="email">E-mail *</label>
    <input type="email" id="email" name="email" required autocomplete="email" />

    <label for="password">Senha *</label>
    <input type="password" id="password" name="password" required autocomplete="current-password" minlength="6" />

    <label for="naturalidade">Naturalidade *</label>
    <input type="text" id="naturalidade" name="naturalidade" required />

    <label for="localAtual">Localização Atual *</label>
    <input type="text" id="localAtual" name="localAtual" required />

    <label for="mpesa">M-Pesa (Número para pagamento) *</label>
    <input type="text" id="mpesa" name="mpesa" pattern="\\d{9,15}" title="Apenas números" required inputmode="numeric" />

    <label for="emola">E-mola (Número para pagamento) *</label>
    <input type="text" id="emola" name="emola" pattern="\\d{9,15}" title="Apenas números" required inputmode="numeric" />

    <label for="mquesh">M-Quesh (Número para pagamento)</label>
    <input type="text" id="mquesh" name="mquesh" pattern="\\d{9,15}" title="Apenas números" inputmode="numeric" />

    <label for="paypal">PayPal (E-mail para pagamento)</label>
    <input type="email" id="paypal" name="paypal" autocomplete="email" />

    <label for="contaBanco">Conta Bancária (Nome do titular e número)</label>
    <input type="text" id="contaBanco" name="contaBanco" />

    <button type="submit" aria-label="Entrar ou cadastrar-se">Entrar / Cadastrar</button>
  </form>
</div>

<!-- Quiz -->
<div class="container" id="quizContainer" role="main" aria-live="polite" aria-atomic="true" aria-label="Quiz de perguntas de saúde">
  <div id="question" tabindex="0" aria-live="assertive"></div>
  <div id="answers"></div>
  <div id="timerBar" aria-hidden="true"><div id="timerFill"></div></div>
  <div id="scoreBoard" aria-live="polite" aria-atomic="true" aria-label="Pontuação do jogador">Pontos: 0</div>
  <button id="btnViewRanking" aria-label="Ver lista dos vencedores">Ver Vencedores</button>
  <button id="btnLogout" aria-label="Sair do sistema">Sair</button>
</div>

<!-- Ranking -->
<div class="container" id="rankingContainer" aria-label="Lista dos maiores pontos">
  <h2>Top 10 Jogadores da Semana</h2>
  <ul id="rankingList" role="list"></ul>
  <button id="btnBackToQuiz" aria-label="Voltar para o quiz">Voltar ao Quiz</button>
</div>

<!-- Admin -->
<div class="container" id="adminArea" aria-label="Área administrativa">
  <h2>Área do Administrador</h2>
  <div id="adminButtons">
    <button id="btnResetRanking" aria-label="Zerar pontos e ranking">Zerar Ranking</button>
    <button id="btnViewUsers" aria-label="Ver usuários cadastrados">Ver Usuários</button>
    <button id="btnLogoutAdmin" aria-label="Sair da área administrativa">Sair Admin</button>
  </div>
  <div id="adminUsersList" style="max-height:300px; overflow:auto; margin-top:12px;"></div>
</div>

<!-- Banner de anúncios fixo no Quiz -->
<div id="adBanner" aria-label="Anúncio publicitário" role="region">
  <!-- Aqui você deve inserir seu código real do Google AdSense -->
  <span>Anúncios Google AdSense - Ganhe enquanto joga!</span>
</div>

<!-- Áudio do Timer -->
<audio id="audioTick" src="https://actions.google.com/sounds/v1/alarms/clock_tick.ogg" preload="auto"></audio>

<script>
(() => {
  // Configurações e variáveis
  const STORAGE_USERS = "zqsaude_users";
  const ADMIN_EMAIL = "admin@zqsaude.com";
  const ADMIN_PASS = "ZefraQuiz+";
  const TIMER_SECONDS = 15;
  const MIN_POINTS_FOR_PRIZE = 10; // Pontos mínimos para aparecer no ranking
  const MAX_TOP_PLAYERS = 10;

  let users = [];
  let currentUser = null;

  // Perguntas simuladas (1000 perguntas simples exemplo)
  const questions = [];
  for(let i=1; i<=1000; i++) {
    questions.push({
      question: `Pergunta ${i}: Qual a função do coração?`,
      options: [
        "Bombear sangue",
        "Filtrar sangue",
        "Produzir hormônios",
        "Armazenar energia"
      ],
      correctAnswer: "Bombear sangue"
    });
  }

  // Estado quiz
  let questionOrder = [];
  let questionIndex = 0;
  let timerInterval = null;
  let timeLeft = TIMER_SECONDS;
  let audioTick = document.getElementById("audioTick");

  // Elementos DOM
  const splashEl = document.getElementById("splash");
  const loginContainer = document.getElementById("loginContainer");
  const loginForm = document.getElementById("loginForm");
  const quizContainer = document.getElementById("quizContainer");
  const questionEl = document.getElementById("question");
  const answersEl = document.getElementById("answers");
  const timerFill = document.getElementById("timerFill");
  const scoreBoard = document.getElementById("scoreBoard");
  const btnLogout = document.getElementById("btnLogout");
  const btnViewRanking = document.getElementById("btnViewRanking");
  const rankingContainer = document.getElementById("rankingContainer");
  const rankingList = document.getElementById("rankingList");
  const btnBackToQuiz = document.getElementById("btnBackToQuiz");
  const adminArea = document.getElementById("adminArea");
  const btnResetRanking = document.getElementById("btnResetRanking");
  const btnViewUsers = document.getElementById("btnViewUsers");
  const adminUsersList = document.getElementById("adminUsersList");
  const btnLogoutAdmin = document.getElementById("btnLogoutAdmin");
  const adBanner = document.getElementById("adBanner");

  // Funções utilitárias
  function getUsers() {
    const stored = localStorage.getItem(STORAGE_USERS);
    return stored ? JSON.parse(stored) : [];
  }
  function saveUsers() {
    localStorage.setItem(STORAGE_USERS, JSON.stringify(users));
  }
  function shuffleArray(arr) {
    for (let i = arr.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [arr[i], arr[j]] = [arr[j], arr[i]];
    }
  }

  // Inicializa
  function init() {
    users = getUsers();
    questionOrder = [...questions];
    shuffleArray(questionOrder);

    setTimeout(() => {
      splashEl.style.display = "none";
      showLogin();
    }, 3500);
  }

  // Mostrar tela login
  function showLogin() {
    loginContainer.style.display = "block";
    quizContainer.style.display = "none";
    rankingContainer.style.display = "none";
    adminArea.style.display = "none";
    adBanner.style.display = "none";
  }

  // Mostrar quiz
  function showQuiz() {
    loginContainer.style.display = "none";
    quizContainer.style.display = "flex";
    rankingContainer.style.display = "none";
    adminArea.style.display = "none";
    adBanner.style.display = "block";
    displayQuestion();
    updateScore();
  }

  // Mostrar ranking
  function showRanking() {
    loginContainer.style.display = "none";
    quizContainer.style.display = "none";
    rankingContainer.style.display = "block";
    adminArea.style.display = "none";
    adBanner.style.display = "none";
    updateRanking();
  }

  // Mostrar admin
  function showAdmin() {
    loginContainer.style.display = "none";
    quizContainer.style.display = "none";
    rankingContainer.style.display = "none";
    adminArea.style.display = "block";
    adBanner.style.display = "none";
    renderUsersTable();
  }

  // Mostrar questão atual
  function displayQuestion() {
    if (questionIndex >= questionOrder.length) {
      shuffleArray(questionOrder);
      questionIndex = 0;
    }
    const current = questionOrder[questionIndex];
    questionEl.textContent = current.question;
    answersEl.innerHTML = "";
    current.options.forEach((opt) => {
      const btn = document.createElement("button");
      btn.className = "answerBtn";
      btn.textContent = opt;
      btn.setAttribute("aria-label", `Responder: ${opt}`);
      btn.onclick = () => answerQuestion(opt);
      answersEl.appendChild(btn);
    });
    startTimer();
  }

  // Começa o timer
  function startTimer() {
    timeLeft = TIMER_SECONDS;
    timerFill.style.width = "100%";
    clearInterval(timerInterval);
    playTickSound();
    timerInterval = setInterval(() => {
      timeLeft--;
      timerFill.style.width = (timeLeft / TIMER_SECONDS) * 100 + "%";
      playTickSound();
      if (timeLeft <= 0) {
        clearInterval(timerInterval);
        answerQuestion(null); // tempo acabou, nenhuma resposta
      }
    }, 1000);
  }

  // Tocar som do tic tac
  function playTickSound() {
    // Para evitar sobreposição do som:
    audioTick.pause();
    audioTick.currentTime = 0;
    audioTick.play().catch(() => {});
  }

  // Responder questão
  function answerQuestion(selected) {
    clearInterval(timerInterval);
    const current = questionOrder[questionIndex];
    if (selected === current.correctAnswer) {
      currentUser.points += 10;
    } else {
      currentUser.points = Math.max(0, currentUser.points - 5);
    }
    updateScore();
    questionIndex++;
    saveUsers();
    displayQuestion();
  }

  // Atualiza placar
  function updateScore() {
    scoreBoard.textContent = `Pontos: ${currentUser.points}`;
  }

  // Atualiza ranking
  function updateRanking() {
    const topUsers = users
      .filter(u => u.points >= MIN_POINTS_FOR_PRIZE)
      .sort((a,b) => b.points - a.points)
      .slice(0, MAX_TOP_PLAYERS);
    rankingList.innerHTML = "";
    topUsers.forEach((u,i) => {
      const li = document.createElement("li");
      li.textContent = `${i+1}. ${u.fullName} — ${u.points} pontos`;
      rankingList.appendChild(li);
    });
  }

  // Renderiza tabela usuários admin
  function renderUsersTable() {
    if (users.length === 0) {
      adminUsersList.innerHTML = "<p>Nenhum usuário cadastrado.</p>";
      return;
    }
    let html = `<table aria-label="Tabela de usuários"><thead>
      <tr><th>Nome</th><th>Email</th><th>Pontos</th><th>Naturalidade</th><th>Localização</th>
      <th>M-Pesa</th><th>E-mola</th><th>M-Quesh</th><th>PayPal</th><th>Conta Bancária</th></tr></thead><tbody>`;
    users.forEach(u => {
    html += `<tr>
        <td>${u.fullName}</td>
        <td>${u.email}</td>
        <td>${u.points}</td>
        <td>${u.naturalidade || ''}</td>
        <td>${u.localAtual || ''}</td>
        <td>${u.mpesa || ''}</td>
        <td>${u.emola || ''}</td>
        <td>${u.mquesh || ''}</td>
        <td>${u.paypal || ''}</td>
        <td>${u.contaBanco || ''}</td>
      </tr>`;
    });
    html += "</tbody></table>";
    adminUsersList.innerHTML = html;
  }

  // Logout geral
  function logout() {
    currentUser = null;
    questionIndex = 0;
    clearInterval(timerInterval);
    showLogin();
  }

  // Reset ranking
  function resetRanking() {
    if (!confirm("Confirma zerar todos os pontos e ranking?")) return;
    users.forEach(u => u.points = 0);
    saveUsers();
    alert("Ranking zerado com sucesso!");
    renderUsersTable();
  }

  // Login ou cadastro
  loginForm.addEventListener("submit", e => {
    e.preventDefault();
    const f = loginForm;
    const fullName = f.fullName.value.trim();
    const email = f.email.value.trim().toLowerCase();
    const password = f.password.value.trim();
    const naturalidade = f.naturalidade.value.trim();
    const localAtual = f.localAtual.value.trim();
    const mpesa = f.mpesa.value.trim();
    const emola = f.emola.value.trim();
    const mquesh = f.mquesh.value.trim();
    const paypal = f.paypal.value.trim();
    const contaBanco = f.contaBanco.value.trim();

    if (!fullName || !email || !password) {
      alert("Nome, e-mail e senha são obrigatórios.");
      return;
    }

    // Login admin especial
    if (email === ADMIN_EMAIL && password === ADMIN_PASS) {
      currentUser = { email: ADMIN_EMAIL, fullName: "Administrador", points: 0 };
      showAdmin();
      return;
    }

    // Procurar usuário
    let user = users.find(u => u.email === email);
    if (user) {
      // Já existe - validar senha
      if (user.password !== password) {
        alert("Senha incorreta.");
        return;
      }
      currentUser = user;
    } else {
      // Criar novo usuário
      user = {
        fullName, email, password,
        naturalidade, localAtual,
        mpesa, emola, mquesh, paypal, contaBanco,
        points: 0
      };
      users.push(user);
      saveUsers();
      currentUser = user;
      alert("Cadastro realizado com sucesso! Bem-vindo(a)!");
    }
    showQuiz();
  });

  // Botões quiz
  btnLogout.onclick = logout;
  btnViewRanking.onclick = showRanking;
  btnBackToQuiz.onclick = showQuiz;

  // Botões admin
  btnLogoutAdmin.onclick = logout;
  btnResetRanking.onclick = resetRanking;
  btnViewUsers.onclick = renderUsersTable;

  // Inicializa o app
  init();

})();
</script>

</body>
</html>